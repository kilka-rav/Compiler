#include <gtest/gtest.h>
#include "./../include/module.h"
#include "./../include/type.h"
#include "./../include/operation.h"


TEST(LoopAnalyzer, TEST1) {
    std::string name = "First task";
    Module application(name);
    auto s = application.getName();
    application.setArgument("I32");
    application.setReturnType("I64");
    
    auto b1 = BasicBlock(0, {0}, {1});
    auto b2 = BasicBlock(1, {0, 4}, {2, 3});
    auto b3 = BasicBlock(2, {1}, {2});
    auto b4 = BasicBlock(3, {1}, {4});
    auto b5 = BasicBlock(4, {3}, {1});

    application.insert(&b1);
    application.insert(&b2);
    application.insert(&b3);
    application.insert(&b4);
    application.insert(&b5);
    
    application.loopAnalyzer();
    auto loops = application.getLoops();
    EXPECT_EQ(1, loops[0].header);
}

